// Created by briansmith on 26/02/2016.
doctype html
html
    head(lang='en')
        meta(charset='utf-8')
        meta(http-equiv='X-UA-Compatible', content='IE=edge')
        meta(name='viewport', content='width=device-width, initial-scale=1')
        meta(name='description', content='')
        meta(name='author', content='')

        link(rel='icon', href='../images/Golf_Pin.ico')

        link(rel='stylesheet', type='text/css', href='../bower_components/bootstrap/dist/css/bootstrap.min.css')
        link(rel='stylesheet', type='text/css', href='../stylesheets/style.css')
        link(rel='stylesheet', type='text/css', href='../stylesheets/custom-bootstrap.css')
        link(rel='stylesheet', type='text/css', href='../stylesheets/popup.css')

        // These MUST be placed in the header
        script(type='text/javascript', src='../bower_components/jquery/dist/jquery.min.js')
        script(type='text/javascript', src='../bower_components/bootstrap/dist/js/bootstrap.min.js')

    title Google Map

    body.index_body
        header
            include partials/header.jade

        main
            .container-fluid
                .row-fluid
                p
                    span.label.label-default EPSG:4326 Long & Lat :
                    span#mouse4326.label.label-info
                    .span12
                        #map.map
                        script.
                            var map;

                            function init() {
                                map = new google.maps.Map(document.getElementById('map'), {
                                    center: {lat: 54.624251, lng: -5.682930},
                                    zoom: 18,
                                    mapTypeId: google.maps.MapTypeId.SATELLITE
                                });

                                var p11 = new google.maps.LatLng(54.625605, -5.683992);
                                var p12 = new google.maps.LatLng(54.623937, -5.683818);

                                    var marker11 = new google.maps.Marker({
                                    position: p11,
                                    map: map,
                                    icon: {
                                        url:"https://maps.gstatic.com/intl/en_us/mapfiles/markers2/measle.png",
                                        size: new google.maps.Size(7,7),
                                        anchor: new google.maps.Point(4,4)
                                    }
                                });

                                var marker2 = new google.maps.Marker({
                                    position: p12,
                                    map: map,
                                    draggable: true,
                                    icon: {
                                        url:"https://maps.gstatic.com/intl/en_us/mapfiles/markers2/measle.png",
                                        size: new google.maps.Size(7,7),
                                        anchor: new google.maps.Point(4,4)
                                    }
                                });

                                google.maps.event.addListener(marker2, 'dragend', function() {
                                    infowindow.setContent(marker2.getPosition().toUrlValue(6));
                                    infowindow.open(map,marker2);
                                });

                                var p1 = new google.maps.Point(0,5);
                                var p2 = new google.maps.Point(5,5);
                                var e = new google.maps.Point(p2.x - p1.x, p2.y - p1.y);
                                var m = new google.maps.Point(e.x/2, e.y/2);
                                var o = new google.maps.Point(0,7);
                                var c = new google.maps.Point(m.x + o.x, m.y + o.y);

                                var marker1 = new google.maps.Marker({
                                    position: new google.maps.LatLng(54.625605, -5.683992),
                                    icon: {
                                        path: "M 0 0 q "+c.x+" "+c.y+" "+e.x+" "+e.y,
                                        scale: 8,
                                        strokeWeight: 2,
                                        fillColor: '#009933',
                                        fillOpacity: 0,
                                        rotation: 180,
                                        clickable: false,
                                        anchor: new google.maps.Point(0,0)
                                    },
                                });
                                marker1.setMap(map);

                                google.maps.event.addListener(map,'zoom_changed',function() {
                                    var zoom = map.getZoom();
                                    var scale = 1/(Math.pow(2,9 - zoom));
                                    var icon = {
                                        path: "M 0 0 q "+c.x+" "+c.y+" "+e.x+" "+e.y,
                                        scale: scale,
                                        strokeWeight: 2,
                                        fillColor: '#009933',
                                        fillOpacity: 0,
                                        rotation: 180,
                                        anchor: new google.maps.Point(0,0)
                                    };
                                    marker.setIcon(icon);
                                });

                            }

                            google.maps.event.addDomListener(window, 'load', init);
        footer
            script(src='https://maps.googleapis.com/maps/api/js?key=AIzaSyBaIVeD83DDFyptO3K--V6YlhvfouDiqOI&callback=init', async='', defer='')
